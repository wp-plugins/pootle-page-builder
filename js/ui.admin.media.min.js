jQuery(function(e){if("undefined"!=typeof wp&&wp.media&&wp.media.editor){var a=wp.media.editor.insert;wp.media.editor.insert=function(n){if(!e("#wp-content-wrap").hasClass("panels-active"))return a(n);if(e(".panel-dialog:visible").length>0)return a(n);if(-1!==n.indexOf("[gallery")){var i=wp.media.gallery.attachments(wp.shortcode.next("gallery",n).shortcode),t=i.models.map(function(e){return e.id}),l=panelsCreatePanel("SiteOrigin_Panels_Widgets_Gallery",{ids:t.join(",")});return void(null==l?a(n):panels.addPanel(l,null,null,!0))}if(-1!==n.indexOf("<a ")||-1!==n.indexOf("<img ")){var l,r=e(n);return"A"==r.prop("tagName")&&"IMG"==r.children().eq(0).prop("tagName")?l=panelsCreatePanel("SiteOrigin_Panels_Widgets_Image",{href:r.attr("href"),src:r.children().eq(0).attr("src")}):"IMG"==r.prop("tagName")?l=panelsCreatePanel("SiteOrigin_Panels_Widgets_Image",{src:r.attr("src")}):"A"!=r.prop("tagName")||-1===r.attr("href").indexOf(".mp4")&&-1===r.attr("href").indexOf(".avi")||(l=panelsCreatePanel("SiteOrigin_Panels_Widgets_Video",{url:r.attr("href")})),void(null==l?a(n):panels.addPanel(l,null,null,!0))}var l=panelsCreatePanel("WP_Widget_Text",{text:n});null==l?a(n):panels.addPanel(l,null,null,!0),a(n)}}}),jQuery(function(e){e("body").on({click:function(a){if("undefined"!=typeof wp&&wp.media&&wp.media.gallery){a.preventDefault();var n=(e(this),e(".panels-admin-dialog:visible")),i=n.find('*[name$="[ids]"]').val();(0===i.indexOf("{demo")||0===i.indexOf("{default"))&&(i="-"),""==i&&null==e("#post_ID").val()&&(i="-");var t=wp.media.gallery.edit('[gallery ids="'+i+'"]');return t.state("gallery-edit").on("update",function(e){var a=e.models.map(function(e){return e.id});n.find('input[name$="[ids]"]').val(a.join(","))}),t.on("escape",function(){n.find(".ui-dialog-content").ppbDialog("open")}),!1}}},".so-gallery-widget-select-attachments")});